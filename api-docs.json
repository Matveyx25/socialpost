{"openapi":"3.0.1","servers":[{"url":"https://localhost/api","description":"Local debug server"}],"security":[{"jwt_token":[]}],"tags":[{"name":"Авторизация"},{"name":"Регистрация"},{"name":"Все пользователи"},{"name":"Администратор"},{"name":"Паблишер"}],"paths":{"/users/{id}":{"get":{"tags":["Администратор"],"summary":"Получить пользователя по id","operationId":"getUserById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}},"put":{"tags":["Администратор"],"summary":"Обновить пользователя по id","operationId":"updateUserById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdateDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}},"delete":{"tags":["Администратор"],"summary":"Удалить пользователя по id","operationId":"deleteUserById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK"}}}},"/users/current":{"get":{"tags":["Все пользователи"],"summary":"Получить текущего пользователя","operationId":"getCurrentUser","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}},"put":{"tags":["Все пользователи"],"summary":"Обновить текущего пользователя","operationId":"updateCurrentUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CurrentUserUpdateDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}},"post":{"tags":["Все пользователи"],"summary":"Указать свою роль (только если роли отсутствуют вообще, т.е. после регистрации)","operationId":"setCurrentUserRole","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetCurrentUserRoleDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/users/current/password":{"put":{"tags":["Все пользователи"],"summary":"Обновить пароль текущего пользователя","operationId":"updateCurrentUserPassword","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserPasswordUpdateDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/users":{"get":{"tags":["Администратор"],"summary":"Получить список всех пользователей","operationId":"getAllUsers","parameters":[{"name":"size","in":"query","required":true,"schema":{"maximum":100,"type":"integer","format":"int32","default":10}},{"name":"page","in":"query","required":true,"schema":{"minimum":0,"type":"integer","format":"int32","default":0}},{"name":"role","in":"query","required":false,"schema":{"type":"string","enum":["PUBLISHER","MANAGER","ADVERTISER","MAIN_ADMIN","ADMIN"]}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageDtoUserDto"}}}}}},"post":{"tags":["Администратор"],"summary":"Создать нового пользователя","operationId":"createUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserByEmailCreateDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/users/registration/by_telegram":{"post":{"tags":["Регистрация"],"summary":"Регистрация через Telegram","operationId":"registerByTelegram","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TelegramCredentials"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/users/registration/by_email":{"post":{"tags":["Регистрация"],"summary":"Регистрация через почту","operationId":"registerByEmail","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserByEmailRegisterDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/users/manager":{"post":{"tags":["Паблишер"],"summary":"Создать менеджера","operationId":"createManager","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ManagerCreateDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/users/current/connect/telegram":{"post":{"tags":["Все пользователи"],"summary":"Привязать Telegram к текущему пользователюю","operationId":"connectTelegram","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TelegramCredentials"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/users/current/connect/email":{"post":{"tags":["Все пользователи"],"summary":"Привязать почту к текущему пользователюю","operationId":"connectEmail","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserEmailConnectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/login/telegram":{"post":{"tags":["Авторизация"],"summary":"Авторизация через Telegram Login Widget","operationId":"loginTelegram","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TelegramCredentials"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AccessTokenDto"}}}}}}},"/login/email":{"post":{"tags":["Авторизация"],"summary":"Авторизация через Email","operationId":"loginEmail","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailCredentials"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AccessTokenDto"}}}}}}}},"components":{"schemas":{"UserUpdateDto":{"required":["firstName","roles"],"type":"object","properties":{"firstName":{"type":"string"},"lastName":{"type":"string"},"photoUrl":{"type":"string"},"roles":{"type":"array","items":{"type":"string","enum":["PUBLISHER","MANAGER","ADVERTISER","MAIN_ADMIN","ADMIN"]}}}},"EmailUserDto":{"required":["email"],"type":"object","properties":{"email":{"type":"string"}}},"TelegramUserDto":{"required":["telegramId"],"type":"object","properties":{"telegramId":{"type":"integer","format":"int32"}}},"UserDto":{"required":["firstName","id","roles"],"type":"object","properties":{"id":{"type":"integer","format":"int32"},"firstName":{"type":"string"},"lastName":{"type":"string"},"photoUrl":{"type":"string"},"telegramData":{"$ref":"#/components/schemas/TelegramUserDto"},"emailData":{"$ref":"#/components/schemas/EmailUserDto"},"roles":{"type":"array","items":{"type":"string","enum":["PUBLISHER","MANAGER","ADVERTISER","MAIN_ADMIN","ADMIN"]}}}},"CurrentUserUpdateDto":{"required":["firstName"],"type":"object","properties":{"firstName":{"type":"string"},"lastName":{"type":"string"},"photoUrl":{"type":"string"}}},"UserPasswordUpdateDto":{"required":["password"],"type":"object","properties":{"password":{"maxLength":2147483647,"minLength":8,"type":"string"}}},"UserByEmailCreateDto":{"required":["email","firstName","roles"],"type":"object","properties":{"email":{"type":"string"},"password":{"maxLength":2147483647,"minLength":6,"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"photoUrl":{"type":"string"},"roles":{"type":"array","items":{"type":"string","enum":["PUBLISHER","MANAGER","ADVERTISER","MAIN_ADMIN","ADMIN"]}}}},"TelegramCredentials":{"required":["authDate","firstName","hash","telegramId"],"type":"object","properties":{"telegramId":{"type":"integer","format":"int32"},"firstName":{"type":"string"},"lastName":{"type":"string"},"username":{"type":"string"},"photoUrl":{"type":"string"},"authDate":{"type":"integer","format":"int32"},"hash":{"type":"string"}}},"UserByEmailRegisterDto":{"required":["email","firstName"],"type":"object","properties":{"email":{"type":"string"},"password":{"maxLength":2147483647,"minLength":6,"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"photoUrl":{"type":"string"}}},"ManagerCreateDto":{"required":["email","firstName"],"type":"object","properties":{"email":{"type":"string"},"password":{"maxLength":2147483647,"minLength":6,"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"photoUrl":{"type":"string"}}},"SetCurrentUserRoleDto":{"type":"object","properties":{"role":{"type":"string","enum":["PUBLISHER","MANAGER","ADVERTISER","MAIN_ADMIN","ADMIN"]}}},"UserEmailConnectDto":{"required":["email"],"type":"object","properties":{"email":{"type":"string"},"password":{"maxLength":2147483647,"minLength":6,"type":"string"}}},"AccessTokenDto":{"type":"object","properties":{"accessToken":{"type":"string"}}},"EmailCredentials":{"required":["email"],"type":"object","properties":{"email":{"type":"string"},"password":{"maxLength":2147483647,"minLength":6,"type":"string"}}},"PageDtoUserDto":{"type":"object","properties":{"totalItemsCount":{"type":"integer","format":"int32"},"items":{"type":"array","items":{"$ref":"#/components/schemas/UserDto"}}}}},"securitySchemes":{"jwt_token":{"type":"http","scheme":"Bearer","bearerFormat":"JWT token"}}}}